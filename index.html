<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LifeDashboard</title>

  <!-- Bulma CSS フレームワーク -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"
  />

  <!-- ダーク／ライト用CSS変数 -->
  <style>
    :root {
      --bg: #ffffff;
      --fg: #222222;
      --primary: #3273dc;
      --input-bg: #f5f5f5;
    }

    [data-theme="dark"] {
      --bg: #121212;
      --fg: #e0e0e0;
      --primary: #209cee;
      --input-bg: #1f1f1f;
    }

    html, body {
      background-color: var(--bg);
      color: var(--fg);
      transition: background-color 0.3s, color 0.3s;
      height: 100%;
    }

    .navbar, .section {
      background-color: var(--bg);
    }

    .button.is-primary {
      background-color: var(--primary);
      border-color: var(--primary);
      color: #ffffff;
    }

    input.input {
      background-color: var(--input-bg);
      color: var(--fg);
      border: 1px solid #ccc;
    }

    .memo-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5em 1em;
      margin-bottom: 0.5em;
      background: var(--input-bg);
      border-radius: 4px;
    }

    .memo-item button {
      background: transparent;
      border: none;
      font-size: 1.2em;
      color: var(--primary);
      cursor: pointer;
    }
  </style>
</head>
<body data-theme="light">

  <!-- ヘッダー -->
  <nav class="navbar">
    <div class="navbar-brand">
      <span class="navbar-item title is-4">LifeDashboard</span>
    </div>
    <div class="navbar-end">
      <div class="navbar-item">
        <button id="theme-btn" class="button is-primary">
          ダークモードに切替
        </button>
      </div>
    </div>
  </nav>

  <!-- メイン -->
  <section class="section">
    <div class="container">
      <!-- 入力 -->
      <div class="field has-addons">
        <div class="control is-expanded">
          <input id="memo-input" class="input" type="text" placeholder="メモを入力…" />
        </div>
        <div class="control">
          <button id="add-btn" class="button is-primary">追加</button>
        </div>
      </div>

      <!-- メモリスト -->
      <div id="memo-list"></div>
    </div>
  </section>

  <!-- スクリプト -->
  <script>
    // 定数
    const THEME_KEY = "ld-theme";
    const MEMO_KEY  = "ld-memos";

    const rootEl   = document.documentElement;
    const themeBtn = document.getElementById("theme-btn");
    const inputEl  = document.getElementById("memo-input");
    const addBtn   = document.getElementById("add-btn");
    const listEl   = document.getElementById("memo-list");

    // テーマ初期化
    const savedTheme = localStorage.getItem(THEME_KEY);
    if (savedTheme) {
      rootEl.setAttribute("data-theme", savedTheme);
      themeBtn.textContent = savedTheme === "dark" ? "ライトモードに切替" : "ダークモードに切替";
    }

    // テーマ切替
    themeBtn.addEventListener("click", () => {
      const current = rootEl.getAttribute("data-theme") || "light";
      const next    = current === "light" ? "dark" : "light";
      rootEl.setAttribute("data-theme", next);
      localStorage.setItem(THEME_KEY, next);
      themeBtn.textContent = next === "dark" ? "ライトモードに切替" : "ダークモードに切替";
    });

    // メモ読み込み
    let memos = JSON.parse(localStorage.getItem(MEMO_KEY) || "[]");

    // メモ描画
    function render() {
      listEl.innerHTML = "";
      if (memos.length === 0) {
        listEl.innerHTML = `<p class="has-text-grey">メモはまだありません。</p>`;
        return;
      }
      memos.forEach((text, idx) => {
        const wrap = document.createElement("div");
        wrap.className = "memo-item";
        wrap.innerHTML = `
          <span>${text}</span>
          <button data-idx="${idx}">🗑️</button>
        `;
        listEl.appendChild(wrap);
      });
      // 削除イベント
      listEl.querySelectorAll("button[data-idx]").forEach(btn => {
        btn.addEventListener("click", e => {
          const i = Number(e.currentTarget.dataset.idx);
          memos.splice(i, 1);
          saveAndRender();
        });
      });
    }

    // 保存＆再描画
    function saveAndRender() {
      localStorage.setItem(MEMO_KEY, JSON.stringify(memos));
      render();
    }

    // 追加処理
    addBtn.addEventListener("click", () => {
      const v = inputEl.value.trim();
      if (!v) return;
      memos.push(v);
      inputEl.value = "";
      saveAndRender();
    });
    inputEl.addEventListener("keypress", e => {
      if (e.key === "Enter") addBtn.click();
    });

    // 初回描画
    render();
  </script>
</body>
</html>
