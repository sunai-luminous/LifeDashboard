<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>LifeDashboard</title>
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"
  />
  <style>
    /* Layout */
    .dashboard {
      display: flex;
      height: 100vh;
    }
    .sidebar {
      width: 240px;
      border-right: 1px solid #ddd;
      background-color: #fff;
    }
    .content {
      flex: 1;
      overflow-y: auto;
      background-color: #f9f9f9;
    }

    /* Active tab underline */
    .tabs.is-toggle li.is-active a {
      border-bottom-color: #3273dc;
      color: #3273dc;
    }

    /* Markdown rendered styling */
    #markdown-rendered h1,
    #markdown-rendered h2,
    #markdown-rendered h3 {
      margin-top: 1em;
    }
    #markdown-rendered ul {
      margin-left: 1em;
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar is-light" role="navigation">
    <div class="navbar-brand">
      <a class="navbar-item" href="#">ğŸ“˜ LifeDashboard</a>
    </div>
  </nav>

  <div class="dashboard">
    <!-- Sidebar -->
    <aside class="menu sidebar">
      <p class="menu-label">ãƒ¡ãƒ‹ãƒ¥ãƒ¼</p>
      <ul class="menu-list">
        <li><a class="is-active" data-target="dashboard">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</a></li>
        <li><a data-target="notes">ãƒãƒ¼ãƒˆ</a></li>
        <li><a data-target="settings">è¨­å®š</a></li>
      </ul>
    </aside>

    <!-- Main Content -->
    <main class="content">
      <!-- Dashboard Section -->
      <section id="dashboard" class="section">
        <h2 class="title is-4">ğŸ  ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h2>
        <p>ã“ã“ã«ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ¦‚è¦ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</p>
      </section>

      <!-- Notes Section -->
      <section id="notes" class="section is-hidden">
        <h2 class="title is-4">ğŸ“ ãƒãƒ¼ãƒˆ</h2>

        <!-- ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ -->
        <div class="tabs is-toggle is-fullwidth">
          <ul>
            <li class="is-active" id="tab-write"><a>å…¥åŠ›</a></li>
            <li id="tab-preview"><a>ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</a></li>
          </ul>
        </div>

        <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ -->
        <div id="editor-pane">
          <textarea
            id="markdown-editor"
            class="textarea"
            rows="12"
            placeholder="Markdownã§è¨˜è¿°..."
          ></textarea>
        </div>

        <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ -->
        <div id="preview-pane" class="box is-hidden">
          <div id="markdown-rendered"></div>
        </div>
      </section>

      <!-- Settings Section -->
      <section id="settings" class="section is-hidden">
        <h2 class="title is-4">âš™ï¸ è¨­å®š</h2>
        <p>è¨­å®šé …ç›®ã‚’ã“ã“ã«è¿½åŠ ã—ã¾ã™ã€‚</p>
      </section>
    </main>
  </div>

  <!-- marked.js for Markdown â†’ HTML -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    // ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼åˆ‡ã‚Šæ›¿ãˆ
    document.querySelectorAll('.menu-list a').forEach(link => {
      link.addEventListener('click', () => {
        // å„ãƒªãƒ³ã‚¯ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–åˆ¶å¾¡
        document.querySelectorAll('.menu-list a').forEach(el =>
          el.classList.remove('is-active')
        );
        link.classList.add('is-active');

        // ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
        const target = link.getAttribute('data-target');
        document.querySelectorAll('main .section').forEach(sec =>
          sec.classList.add('is-hidden')
        );
        document.getElementById(target).classList.remove('is-hidden');

        // ç¾åœ¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä¿å­˜
        localStorage.setItem('lifeDashboardSection', target);
      });
    });

    // Markdownãƒãƒ¼ãƒˆéƒ¨å“
    const tabWrite = document.getElementById('tab-write');
    const tabPreview = document.getElementById('tab-preview');
    const editorPane = document.getElementById('editor-pane');
    const previewPane = document.getElementById('preview-pane');
    const markdownEditor = document.getElementById('markdown-editor');
    const markdownRendered = document.getElementById('markdown-rendered');

    // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆå‡¦ç†
    tabWrite.addEventListener('click', () => {
      tabWrite.classList.add('is-active');
      tabPreview.classList.remove('is-active');
      editorPane.classList.remove('is-hidden');
      previewPane.classList.add('is-hidden');
    });

    tabPreview.addEventListener('click', () => {
      tabPreview.classList.add('is-active');
      tabWrite.classList.remove('is-active');
      editorPane.classList.add('is-hidden');
      previewPane.classList.remove('is-hidden');
      markdownRendered.innerHTML = marked.parse(markdownEditor.value);
    });

    // å…¥åŠ›è‡ªå‹•ä¿å­˜ï¼†ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼åæ˜ 
    markdownEditor.addEventListener('input', () => {
      localStorage.setItem('lifeDashboardNote', markdownEditor.value);
      if (!previewPane.classList.contains('is-hidden')) {
        markdownRendered.innerHTML = marked.parse(markdownEditor.value);
      }
    });

    // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ
    window.addEventListener('DOMContentLoaded', () => {
      // æœ€å¾Œã«è¡¨ç¤ºã—ã¦ã„ãŸã‚»ã‚¯ã‚·ãƒ§ãƒ³
      const savedSection = localStorage.getItem('lifeDashboardSection');
      if (savedSection) {
        document.querySelector(`.menu-list a[data-target="${savedSection}"]`).click();
      }

      // ãƒãƒ¼ãƒˆå†…å®¹ã®å¾©å…ƒ
      const savedNote = localStorage.getItem('lifeDashboardNote');
      if (savedNote) markdownEditor.value = savedNote;
    });
  </script>
</body>
</html>
